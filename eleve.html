<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>RunStats ‚Äî Saisie des informations</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{--bleu:#e6f0ff;--vert:#e6ffe6;--grey:#eef2f7;--border:#e5e7eb}
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,sans-serif;
      background:#fafafa;color:#111;
      font-size:18px; /* ‚Üë police globale l√©g√®rement plus grande */
    }
    header,footer{text-align:center;padding:16px}
    .wrap{max-width:980px;margin:0 auto 40px;padding:0 12px}
    .grid{display:grid;grid-template-columns:1fr;gap:14px}
    @media(min-width:860px){.grid{grid-template-columns:1fr 1fr}}
    .card{border:2px solid var(--border);border-radius:14px;overflow:hidden}
    .c1{background:var(--bleu);border-color:var(--bleu)}
    .c2{background:var(--vert);border-color:var(--vert)}
    .params{background:#fff;border:2px solid var(--grey);border-radius:14px;overflow:hidden}
    .cardHeader{
      padding:12px 14px;font-weight:900;border-bottom:1px solid var(--border);
      letter-spacing:.5px
    }
    .cardBody{padding:14px}
    /* Labels et saisies en gras */
    label{display:block;font-weight:800;margin:10px 0 6px}
    input,select{
      width:100%;padding:12px;border:1px solid var(--border);border-radius:10px;background:#fff;
      font-weight:800; /* texte saisi en gras */
      font-size:1.05rem; /* l√©g√®rement plus grand */
    }
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:16px;justify-content:center}
    button{
      appearance:none;border:1px solid var(--border);background:#111;color:#fff;
      font-weight:800;padding:12px 16px;border-radius:12px;cursor:pointer
    }
    a.btn{display:inline-block;text-decoration:none;border:1px solid var(--border);padding:12px 16px;border-radius:12px;background:#fff}
  </style>
</head>
<body>
  <header>
    <h1>Saisie des informations</h1>
    <p>Identit√© des deux coureurs + param√®tres de course communs.</p>
  </header>

  <div class="wrap">
    <form id="studentForm">
      <div class="grid">
        <div class="card c1">
          <div class="cardHeader">COUREUR 1</div>
          <div class="cardBody">
            <label for="prenom1">Pr√©nom</label>
            <input id="prenom1" required />
            <label for="nom1">Nom</label>
            <input id="nom1" required />
            <label for="classe1">Classe</label>
            <input id="classe1" required />
            <label for="sexe1">Sexe</label>
            <select id="sexe1" required>
              <option value="">‚Äî</option>
              <option value="Fille">Fille</option>
              <option value="Gar√ßon">Gar√ßon</option>
            </select>
          </div>
        </div>

        <div class="card c2">
          <div class="cardHeader">COUREUR 2</div>
          <div class="cardBody">
            <label for="prenom2">Pr√©nom</label>
            <input id="prenom2" required />
            <label for="nom2">Nom</label>
            <input id="nom2" required />
            <label for="classe2">Classe</label>
            <input id="classe2" required />
            <label for="sexe2">Sexe</label>
            <select id="sexe2" required>
              <option value="">‚Äî</option>
              <option value="Fille">Fille</option>
              <option value="Gar√ßon">Gar√ßon</option>
            </select>
          </div>
        </div>
      </div>

      <div class="params" style="margin-top:14px">
        <div class="cardHeader" style="background:var(--grey)">Param√®tres de course (communs)</div>
        <div class="cardBody">
          <div class="grid" style="grid-template-columns:1fr 1fr">
            <div>
              <label for="temps">Dur√©e (minutes)</label>
              <input id="temps" type="number" min="1" step="1" required
                     inputmode="numeric" pattern="[0-9]*" data-digits-only />
            </div>
            <div>
              <label for="longueur">Longueur d‚Äôun tour (m)</label>
              <input id="longueur" type="number" min="1" step="1" required
                     inputmode="numeric" pattern="[0-9]*" data-digits-only />
            </div>
          </div>
        </div>
      </div>

      <div class="actions">
        <button type="submit">Acc√©der √† la course</button>
        <a class="btn" href="index.html">üè† Accueil</a>
      </div>
    </form>
  </div>

  <footer>RunStats - √âquipe EPS Lyc√©e Vauban - LUXEMBOURG - JB</footer>

  <script>
    // Helper local pour ne garder que des chiffres
    const onlyDigits = (v) => (v || "").toString().replace(/[^\d]/g, "");

    document.getElementById("studentForm").addEventListener("submit", (e) => {
      e.preventDefault();

      const tempsEl = document.getElementById("temps");
      const longEl  = document.getElementById("longueur");

      // Ceinture-bretelles : nettoyage avant usage
      tempsEl.value = onlyDigits(tempsEl.value);
      longEl.value  = onlyDigits(longEl.value);

      // Si vide apr√®s nettoyage, on laisse le navigateur afficher la validation native
      if (!tempsEl.value || !longEl.value) {
        if (typeof e.target.reportValidity === "function") e.target.reportValidity();
        return;
      }

      const communs = {
        temps: parseInt(tempsEl.value, 10),
        longueurTour: parseInt(longEl.value, 10)
      };

      const eleve1 = {
        prenom: prenom1.value.trim(),
        nom: nom1.value.trim(),
        classe: classe1.value.trim(),
        sexe: sexe1.value, // "Fille" | "Gar√ßon"
        ...communs
      };

      const eleve2 = {
        prenom: prenom2.value.trim(),
        nom: nom2.value.trim(),
        classe: classe2.value.trim(),
        sexe: sexe2.value, // "Fille" | "Gar√ßon"
        ...communs
      };

      sessionStorage.setItem("eleve1Data", JSON.stringify(eleve1));
      sessionStorage.setItem("eleve2Data", JSON.stringify(eleve2));

      // Acc√©der √† la page course du coureur 1, sans d√©marrer automatiquement le chrono
      window.location.href = "course.html?runner=1&autostart=0";
    });
  </script>

  <!-- Moteur "chiffres uniquement" pour les inputs marqu√©s data-digits-only -->
  <script>
    (() => {
      const SEL = '[data-digits-only]';
      const onlyDigits = v => (v || '').toString().replace(/[^\d]/g, '');

      // Bloque l'insertion de caract√®res non num√©riques
      document.addEventListener('beforeinput', (e) => {
        const el = e.target;
        if (!el || !el.matches?.(SEL)) return;
        if (e.data && /\D/.test(e.data)) e.preventDefault();
      }, { capture: true });

      // Nettoie en direct (utile si un caract√®re passe quand m√™me, ou via clavier physique)
      document.addEventListener('input', (e) => {
        const el = e.target;
        if (!el || !el.matches?.(SEL)) return;
        const before = el.value;
        const after  = onlyDigits(before);
        if (before !== after) {
          const delta = before.length - after.length;
          const pos = el.selectionStart;
          el.value = after;
          if (pos != null) {
            const caret = Math.max(0, pos - delta);
            el.setSelectionRange(caret, caret);
          }
        }
      });

      // Nettoie le collage
      document.addEventListener('paste', (e) => {
        const el = e.target;
        if (!el || !el.matches?.(SEL)) return;
        e.preventDefault();
        const text = (e.clipboardData || window.clipboardData).getData('text');
        const ins  = onlyDigits(text);
        const start = el.selectionStart ?? el.value.length;
        const end   = el.selectionEnd ?? el.value.length;
        el.value = el.value.slice(0, start) + ins + el.value.slice(end);
        const caret = start + ins.length;
        el.setSelectionRange(caret, caret);
      });
    })();
  </script>
</body>
</html>
